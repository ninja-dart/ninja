import 'dart:math';

import 'package:ninja/asymmetric/rsa/rsa.dart';
import 'package:test/test.dart';

void main() {
  group('rsa', () {
    group('PublicKey', () {
      test('fromASN1', () {
        final key = RSAPublicKey.fromASN1(
            'MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANsFjQ22G36v8jGhcOtCnWtkuqqI9mWOq5I6Gy4NBb46ch2+gXL8/sC37X2BGASnt2YymAm7xwS2+QE89YYvDdECAwEAAQ==');
        expect(key.n.toString(),
            '11471096350072129820579819100426547181616187185658504704996065334930805271197099322753245009150228584617512330162571541229290378786994493391408050685808081');
        expect(key.e.toString(), '65537');
      });
    });

    group('PrivateKey.fromASN1', () {
      test('pkcs#1', () {
        final key = RSAPrivateKey.fromASN1(
            'MIICXQIBAAKBgQDzskNxV392BhufbSVyC3whpO71XOHf3/DWPyUfNKG1ca7EhVqRRFKfFNXubYevjA2VeXCEU2RNa5NmHL8PmHyr22weDD2KJ0YZBE9RzPs/uh1SX8Nz9ZbLSOpvj49W4io6vT2rp5+Bbv26LhC/zG8dN5eTX9Ftohl5H0tdjNL7KwIDAQABAoGAQPFbqcPQkupTyCu1E+xdmzWx/K9Q/nFWZDIVuXg0M/9kvLhxB0922TAbRtvnke+32wKu6oSysTMe59J3VDel2T2N5F2PoFdcWmD9p5VPMIEKEBuAKOmLcH5MQz2rS2NZ0NB8bEkGHey2Wg8z3J6mYgUMuEw7fx1//npESPaoksECQQD+KMMR/qKbP1iaUFBSLDkL3WatyV1DTaG41PQpTHqoCNK/VQaTe1oPDLIqCe2Ns+4zlGjnWDTfP0RTeZmaLIjhAkEA9XYaJ1kg/c4tDaLjH68W3A/a9loe/0OMPlrolkmHXPRjsVFdOBsU0gUSbeqXwKid8LJ0WNhF5QhwAp0y6KzJiwJAGaRbKfGazjbx5X+82s2DY+MOfPIX6rZmXpN9nr0Mku9w88TMSQzk5SfOwdcGlIlWuvV6L/0COJPVfOaDzL45gQJBAOCNBGwOu4G0hb69zq2DjZQP5S4NT+IRt1Cr9a7W4UCGSlVCq9bR34AqJ6vqOp2DI8m4V3uXjolx6JZbnOECgPUCQQC+CM/Tz3UyGYoSg6o/yTqZ153qzFBJ0XcyWWwaRz9JGNrCdbYXb1DTPXO6SBWCLDOCqdbMyZMPtOOS6V0FbbU6');
        expect(key.n.toString(), '171129390732660146419855445296498843421793035030054831713262981408625437665094702312259284413650823228768400998091771955907248594823945968177282058399113440833717891845878510897107129982740734254769006318233816359540806364511460644786857687183121930295493705392002305111095244518677061258616435153725547543339');
        expect(key.e.toString(), '65537');
        expect(key.d.toString(), '45604388500326677407003301220735650096306137858002466330044676599503231286462288110282869253771329595349804285085872060209043696058718225341657859681409215971891059140039798588354778837282844347377082841148663576431973647684265700447716249156331224982434547267381784694326011259136737257925826558124460905153');
        expect(key.p.toString(), '13311398800872123545509265659481938261907941937028495771208440340566859520917728290659412695924049986718341601969223777955429912069271339711686707239487713');
        expect(key.q.toString(), '12855853339879521453788356377992413936990740503119663040008894782605651726660339873651248325834950126916952352810922413550188676566583744808486210819115403');
      });
      test('pkcs#8', () {
        final key = RSAPrivateKey.fromASN1(
            'MIIBVQIBADANBgkqhkiG9w0BAQEFAASCAT8wggE7AgEAAkEA2wWNDbYbfq/yMaFw60Kda2S6qoj2ZY6rkjobLg0FvjpyHb6Bcvz+wLftfYEYBKe3ZjKYCbvHBLb5ATz1hi8N0QIDAQABAkEAtR0oATigD+kLDEOGDuVtK4uGWNMdfem2sxrdsv0NzLkcWZ6u6XRfq1G7dCagiGom4B93y6UR0KYQvPGLD+DHiQIhAO16txmxxKLU7XJ5Mj7vCg88EpU5DjptyT7GDM0dHADXAiEA7BpT3JnuY5M0RTuHSzcaqSB8p2oVP3h60ebnwHsVCZcCIBx5ZE7uY7dqdHYPVhj5rGkbONcvmicjVsfyE0LcxKjNAiEAjzw9qjScoj441NOTdbcdboNt/GboMxRVdqgd6vEAx0sCIEifY2LV3oO4JJCUN8aRjFJlAXe1vTnDnQLOD/u844Ed');
        print(key);

        expect(key.n.toString(), '11471096350072129820579819100426547181616187185658504704996065334930805271197099322753245009150228584617512330162571541229290378786994493391408050685808081');
        expect(key.e.toString(), '65537');
        expect(key.d.toString(), '9485704191461449311022822471710885422898632045097837923349508899724431403134778704337322169999541158279872714205624099708799374418241860212545272420550537');
        expect(key.p.toString(), '107414964168438393293800370153762414263170982299670223259057985688128607486167');
        expect(key.q.toString(), '106792349081681004195940644966825657043901438347969492098043946341032927758743');
      });
    });
  });
}
